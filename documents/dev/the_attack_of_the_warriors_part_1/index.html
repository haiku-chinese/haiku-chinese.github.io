<!doctype html><html lang=en>
<!-- Mirrored from www.haiku-os.org/documents/dev/the_attack_of_the_warriors_part_1/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 05 Aug 2021 01:34:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content="hardware,kernel,I/O,USB"><meta name=copyright content="2001-2021 Haiku Inc."><meta property="og:site_name" content="Haiku Project"><meta property="og:title" content="The Attack Of The Warriors, Part 1"><meta property="og:url" content="https://www.haiku-os.org/documents/dev/the_attack_of_the_warriors_part_1/"><meta property="og:type" content="website"><meta property="og:image" content="https://www.haiku-os.org/images/haiku_600x315.png"><title>The Attack Of The Warriors, Part 1 | Haiku Project</title><link rel=canonical href=https://www.haiku-os.org/documents/dev/the_attack_of_the_warriors_part_1/><link rel="shortcut icon" href=https://www.haiku-os.org/favicon.ico><link href=https://www.haiku-os.org/css/bootstrap.min.css rel=stylesheet><link href=https://www.haiku-os.org/css/bootstrap4_fixes.css rel=stylesheet><link href=https://www.haiku-os.org/css/shijin4.css rel=stylesheet></head><body><div id=page><a href=https://www.haiku-os.org/><img src=https://www.haiku-os.org/images/haiku_logo_white.svg alt=Home id=logo height=100 style=padding-left:3px></a><div id=top-links><a href=https://www.haiku-os.org/get-haiku title="Get Haiku!" class=toggleopacity><img src=https://www.haiku-os.org/images/download_32.png text="get haiku!" alt=Download></a>
<a href=https://www.haiku-os.org/contact title="Contact the Haiku Project" class=toggleopacity><img src=https://www.haiku-os.org/images/App_Mail_32.png text="contact the haiku project" alt=Contact></a>
<a href=https://www.haiku-os.org/community/donating_to_haiku title="Make a donation to the Haiku Project" class=toggleopacity><img src=https://www.haiku-os.org/images/App_Finance_32.png alt=Donate text="make a donation to the haiku project"></a>
<a href=https://dev.haiku-os.org/ title="Report bugs" class=toggleopacity><img src=https://www.haiku-os.org/images/bug_tracker_32.png alt="Report Bugs" text="report bugs related to haiku"></a>
<a href=https://depot.haiku-os.org/ title="Download apps for Haiku from HaikuDepot" class=toggleopacity><img src=https://www.haiku-os.org/images/installer_32.png alt=HaikuDepot text="download apps for haiku from haikudepot"></a></div><nav class="navbar navbar-expand-sm navbar-light bg-light"><button class="navbar-toggler collapsed" id=navbar-toggler type=button data-toggle=collapse data-target=#navbar-collapseme aria-controls=navbar-collapseme aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbar-collapseme><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=https://www.haiku-os.org/about/>About</a></li><li class=nav-item><a class=nav-link href=https://www.haiku-os.org/community/>Community</a></li><li class=nav-item><a class=nav-link href=https://www.haiku-os.org/development/>Development</a></li><li class=nav-item><a class=nav-link href=https://www.haiku-os.org/documents/>Documents</a></li></ul><form class=form-inline role=search action=https://duckduckgo.com/><input type=hidden name=sites value=https://www.haiku-os.org><div class=input-group><input type=text class=form-control placeholder=Search name=q>
<span class=input-group-append><button type=submit class="btn btn-outline-secondary">&#x1f50d;</button></span></div></form></div></nav><div class=row id=main-front><div class=col-sm-12><ol class=breadcrumb><li class=breadcrumb-item><a href=https://www.haiku-os.org/>Home</a></li><li class=breadcrumb-item><a href=https://www.haiku-os.org/documents/>Documents</a></li><li class=breadcrumb-item><a href=https://www.haiku-os.org/documents/dev/>Developer Documents</a></li><li class=breadcrumb-item><a href=https://www.haiku-os.org/documents/dev/the_attack_of_the_warriors_part_1/>The Attack Of The Warriors, Part 1</a></li></ol></div><div class=col-md-12><div class=node><h1 class=title>The Attack Of The Warriors, Part 1</h1><div class=meta><div class=terms><a href=https://www.haiku-os.org/tags/hardware rel=tag>hardware</a>,
<a href=https://www.haiku-os.org/tags/kernel rel=tag>kernel</a>,
<a href=https://www.haiku-os.org/tags/i/o rel=tag>I/O</a>,
<a href=https://www.haiku-os.org/tags/usb rel=tag>USB</a></div></div><p><span class="inline center" style=width:400px><a href=https://www.haiku-os.org/ onclick="launch_popup(446,937,484);return false;" target=_blank><img src=http://www.haiku-os.org/files/screenshots/HaikuNewsletter57Article1Image1.img_assist_custom.jpg alt="Figure 1: JoyWarrior24 A8-8 USB Joystick Controller Schematic" title="Figure 1: JoyWarrior24 A8-8 USB Joystick Controller Schematic" class="image img_assist_custom" height=207 width=400></a><span class=caption style=width:398px><strong>Figure 1: JoyWarrior24 A8-8 USB Joystick Controller Schematic</strong></span></span><p>JoyWarrior24 A8-8 can manage three analog potentiometer axes with 8-bit resolution each. Furthermore up to eight buttons can be connected directly to the chip. But how can the joystick be controlled by BeOS? Where is the hardware driver? Don't panic--no dedicated driver is necessary for our purpose--you only need Be's USB bus manager, the raw driver, and the USB kit. However, if you really want to play "Flight" (located inside the Demos folder), then use <a href=http://www.bebits.com/app/1688>USB Joystick Driver</a>. So, don't hesitate, get the hardware, do some soldering and make the connection to your PC running BeOS (Code Mercenaries supports Windows, MacOS and Linux). Wait a moment - it's better to use a cost-effective 4-port USB-Hub to connect to the computer. You then will be well-prepared for the following newsletters where more USB-circuits will be introduced. The hub serves two purposes: Four USB devices can be connected simultaneously and the hub will disconnect from the PC in case of a short circuit. All connections done? Well, first launch USBCommander v0.2 - I debugged version 0.1 to enhance stability.</p><span class="inline center" style=width:306px><img src=http://www.haiku-os.org/files/screenshots/HaikuNewsletter57Article1Image2.jpg alt="Figure 2: JoyWarrior24 A8-8 USB Joystick Controller" title="Figure 2: JoyWarrior24 A8-8 USB Joystick Controller" class="image img_assist_custom" height=451 width=306><span class=caption style=width:304px><strong>Figure 2: JoyWarrior24 A8-8 USB Joystick Controller</strong></span></span><p>You see the Standard USB Hub at /0/1 and two CodeMercenaries devices. The JoyWarrior A8-8 at /0/1/2 is connected to port number 2 of the hub (ports are counted from 0 to 3, the physical port in this case is 3). Let's have a look at the USB Device Info window. We find a single configuration using a single interface and an endpoint receiving data via Interrupt-Transfer. The data size is 4 bytes and every 10 ms data can be accepted. Getting this data is done using only a few lines of code.</p><span class="inline center" style=width:409px><img src=http://www.haiku-os.org/files/screenshots/HaikuNewsletter57Article1Image3.jpg alt="Figure 3: USB Device Info" title="Figure 3: USB Device Info" class="image img_assist_custom" height=404 width=409><span class=caption style=width:407px><strong>Figure 3: USB Device Info</strong></span></span><p>The essential lines of code of the command-line version of JoyWarrior are the followings:</p><ul><li>USBDevice dev(argv[1]): the USBDevice class is initialized from a path to the raw USB device at /dev/bus/usb/0/1/2.</li><li>dev.SetConfiguration(dev.ConfigurationAt(0)): configure device using configuration 0.</li><li>const USBEndpoint *ept = dev.ActiveConfiguration()-> . . .: get access to the endpoint where all transfers are performed.</li><li>ept->InterruptTransfer(data,4): get 4 bytes of data via Interrupt-Transfer.</li></ul><p>Now quit the USBCommander application and start JoyWarrior. Use the Tracker add-on "Summon" to launch a terminal related to the current directory where JoyWarrior is located, type JoyWarrior, add the path, and press Return. Then you can add or remove the jumpers or manipulate the potentiometers and observe how data is changing. You can cancel all action by typing Ctrl + C or closing the terminal.</p><span class="inline center" style=width:306px><img src=http://www.haiku-os.org/files/screenshots/HaikuNewsletter57Article1Image4.jpg alt="Figure 4: JoyWarrior" title="Figure 4: JoyWarrior" class="image img_assist_custom" height=336 width=306><span class=caption style=width:304px><strong>Figure 4: JoyWarrior</strong></span></span><p>If you like it more comfortable then try StickIt, written by Be Inc. to demonstrate the new BJoystick class. The JoyWarrior device is recognized as a "Generic USB Joystick". Of course you must have installed the above mentioned driver.</p><span class="inline center" style=width:349px><a href=https://www.haiku-os.org/ onclick="launch_popup(450,817,449);return false;" target=_blank><img src=http://www.haiku-os.org/files/screenshots/HaikuNewsletter57Article1Image5.img_assist_custom.jpg alt="Figure 5: StickIt" title="Figure 5: StickIt" class="image img_assist_custom" height=192 width=349></a><span class=caption style=width:347px><strong>Figure 5: StickIt</strong></span></span>
<span class="inline center" style=width:425px><img src=http://www.haiku-os.org/files/screenshots/HaikuNewsletter57Article1Image6.jpg alt="Figure 6: Joystick Preflet" title="Figure 6: Joystick Preflet" class="image img_assist_custom" height=353 width=425><span class=caption style=width:423px><strong>Figure 6: Joystick Preflet</strong></span></span><p>If you don't like the driver then launch the GUI version of "JoyWarrior" . Don't forget to insert the proper vendor ID, product ID, and serial number. USBCommander will deliver you this information. Finally, press "Search USB Device", and if the dedicated device is present the product string will be displayed. The "Start/Stop Receiving" button is now enabled to start the communication between the joystick and your PC.</p><p>Last but not least, you can hot-plug the device. When the JoyWarrior is removed from the bus, the communication is cancelled, and after reconnecting, the device will be recognized again.</p><p>A joystick isn't an overwhelming piece of hardware and is shown here only for demonstrating purpose. The next article will deal with IO-Warrior24 and IO-Warrior40, two generic universal I/O controllers for USB... and for BeOS.</p><span class="inline center" style=width:398px><img src=http://www.haiku-os.org/files/screenshots/HaikuNewsletter57Article1Image7.jpg alt="Figure 7: Hot-plugged" title="Figure 7: Hot-plugged" class="image img_assist_custom" height=337 width=398><span class=caption style=width:396px><strong>Figure 7: Hot-plugged</strong></span></span>
<span class="inline center" style=width:393px><img src=http://www.haiku-os.org/files/screenshots/HaikuNewsletter57Article1Image8.jpg alt="Figure 8: Not-plugged" title="Figure 8: Not-plugged" class="image img_assist_custom" height=329 width=393><span class=caption style=width:391px><strong>Figure 8: Not-plugged</strong></span></span></div></div></div></p></div></div></div><footer><div style=float:right><a href=https://www.netlify.com/><img src=https://www.netlify.com/img/global/badges/netlify-dark.svg alt="Deploys by Netlify"></a></div><p>&copy; 2001-2021 Haiku, Inc. &mdash; Haiku&reg; and the HAIKU logo&reg; are registered trademarks of <a href=https://www.haiku-inc.org/ target=_blank>Haiku, Inc.</a></p><p class=last><a href=https://www.haiku-os.org/index.xml>Main feed</a> |
<a href=https://www.haiku-os.org/blog/index.xml>Blog-O-Sphere feed</a> |
<a href=https://www.haiku-os.org/community/organization/policies/>Community policies</a> |
<a href=https://twitter.com/haikuOS>Twitter</a> |
<a href=https://mastodon.xyz/@haiku>Mastodon</a> |
<a href=https://www.linkedin.com/company/haiku-inc->LinkedIn</a></p></footer></div><link href="https://fonts.googleapis.com/css?family=Noto+Sans:400,400i,700,700i" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel=stylesheet><script src=https://www.haiku-os.org/js/navbar.js></script><!-- Fathom -->
<script>
(function(f, a, t, h, o, m){
	a[h]=a[h]||function(){
		(a[h].q=a[h].q||[]).push(arguments)
	};
	o=f.createElement('script'),
	m=f.getElementsByTagName('script')[0];
	o.async=1; o.src=t; o.id='fathom-script';
	m.parentNode.insertBefore(o,m)
})(document, window, 'https://metrics.haiku-os.org/tracker.js', 'fathom');
fathom('trackPageview');
</script>
<!-- / Fathom --></body>
<!-- Mirrored from www.haiku-os.org/documents/dev/the_attack_of_the_warriors_part_1/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 05 Aug 2021 01:34:57 GMT -->
</html>